<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css" integrity="sha384-DyZ88mC6Up2uqS4h/KRgHuoeGwBcD4Ng9SiP4dIRy0EXTlnuz47vAwmeGwVChigm" crossorigin="anonymous">

    <title>Movies</title>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ephesis&display=swap');
        body{
            background-color: #091353;
        }
        #movies{
            display: grid;
            grid-template-columns: repeat(4,23%);
            width: 90%;
            margin:100px auto;
            justify-content: center;
            justify-items: center;


        

        }
        #movies>div{
            width: 250px;
            margin-top: 30px;
            background-color: #9D84B7;
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.7s;
            position: relative;
            
        }
         #movies>div:hover{
                        transform: scale(1.1);
        }
        #movies >div>img{
               height: 250px;
               width: 100%;
        }
         #movies >div>p{
               padding-left: 10px;
               color: #D5D5D5;
               font-size: large;
               font-family: Verdana, Geneva, Tahoma, sans-serif;
                  padding-right: 10px;
                  margin: 0 ;
        }

        #input{
            width: 90%;
            margin: auto;
            text-align: center;  
            /* margin-top: 100px; */
            background-color: #8c73a795;
            height: 100px;
            border-radius: 10px;
            line-height: 100px;
            position: relative;


        }
        #movie{
                height: 50px;
                width: 600px;
                border: none;
                background-color: beige;
                padding-left: 20px;
                border-radius: 10px;
                font-size: 20px;
                
        }
        /* #input>button{
             height: 50px;
                width: 150px;
                border-radius: 50px;
                margin-left: 50px;
                  transition: 0.5s;
                font-size: large;
        }
        #input>button:hover{
            transform: scale(1.1);

        } */
        #no-result{
             margin-top: 20px;    
          

        }
        #no-result>img{
           width: 90%;
           height: 600px;
           display: block;
           margin: auto;
           border-radius: 10px;
        }
       h1{
           text-align: center;
           color: #B2F9FC;
           font-size: 70px;
           font-family: 'Ephesis', cursive;
           letter-spacing: 10px;
           margin: 0;
       }
       i{
           position: absolute;
           top: 1%;
           right: 1%;
           font-size: 50px;
           color: white;
       }
       #search{
           margin:  0 auto;
           width: 400px;
           position: absolute;
           background-color: #D5D5D5;
         left: 30%;
         z-index: 1;
         max-height: 500px;
         overflow-y: scroll;

          display: flex;
           flex-direction: column;
           border: none;
           box-shadow: 0 10px 10px black;
           border-radius: 10px;
         
       }
       #search>div>img{
           height: 125px;
           
       }
    
       #search>div{
        margin: 10px;   
        display: flex; 
        gap: 20px;
       }
       #search>div>p{
           font-size: 24px;
           font-family: Verdana, Geneva, Tahoma, sans-serif;
       }
       @media only screen and (max-width:1200px) {

         #movies{
            grid-template-columns: repeat(3,30%);
        }
           
       }
       @media only screen and (max-width:900px) {

         #movies{
            grid-template-columns: repeat(2,40%);
        }
           
       }
       #detail{
            width: 90%;
            margin: auto;
            background-color: #8c73a795;
            border-radius: 10px;
            margin-top: 50px;
            display: grid;
            grid-template-columns:  30% 40%;
            grid-gap: 20px;
            overflow:hidden;
       }
       #detail>div>img{
           height: 400px;
           width: 100%;
       }
       #detail>div>p{
           font-size: 25px;
       }
        
    </style>
</head>
<body>
    <h1 onclick="returnToHome()">Info.Movies</h1>
   <div id="input">
        <input type="text" id="movie" placeholder="Search Movie" oninput="searchMovie()">
        <div id="search" ></div>
    
   </div>
   <!-- <div id="no-result"> -->

   </div>
   <div id="detail">

   </div>
   <div id="category">
       but
   </div>
       <div id="movies">
           <!-- all the movies in the form of a grid  -->

       </div>
    <script>
        




        //get movie on search 
async function getMovie(movie_name){
    let res = await fetch(`https://api.themoviedb.org/3/search/movie?api_key=d96691ff21105442b23e5deb93e504f5&query=${movie_name}`);
    //c8cb72f9
    let data = await res.json();
    // console.log(data.Search)
    //if no data recieved
    // console.log(data)
    console.log(data)

    if(data.results===undefined){
       let parent = document.getElementById("search");
       parent.innerHTML = null;
       parent.innerHTML = `<h1> Not Found</h1>`;
  
    }else{

     let parent = document.getElementById("search");
     parent.innerHTML = null;
    console.log(data.results);
    
       showSearch(data.results);
    
    }

}

async function showPopular(){
    let res = await fetch(`https://api.themoviedb.org/3/discover/movie?api_key=d96691ff21105442b23e5deb93e504f5&sort_by=popularity.desc`);
    
    let data = await res.json();

    showMovie(data.results)

}
showPopular();



function showMovie(movies){
    let parent = document.getElementById("movies");
    parent.innerHTML = null;
   


    movies.forEach(function(movie){
         let div = document.createElement("div");
         div.setAttribute("class","movie");

         let img = document.createElement("img");
         img.src = "https://image.tmdb.org/t/p/w500"+movie.poster_path;
        //  img.alt ="no image available";

         let title = document.createElement("p");
         title.innerText ="Title-" +movie.title;

         let year = document.createElement("p");
         year.innerText = "Year-"+movie.release_date.slice(0,4);


         let imdb = document.createElement("p");
         imdb.innerText = "imdb rating-"+ movie.vote_average;

         if(movie.vote_average > 8.5){
             let recom = document.createElement("p");
             recom.innerHTML =` <i class="fas fa-thumbs-up"></i> `;
            
             div.append(img,title,year,imdb,recom);

         }else{

             div.append(img,title,year,imdb);
         }
          //add event listener 
         div.addEventListener("click",function(){
          console.log(movie);
          showDetail(movie);
          //colapse the search div

              let parent = document.getElementById("search");
       parent.innerHTML = null;

         })

         parent.append(div);



    });
    
}

function searchMovie(){
    let movie = document.getElementById("movie").value;
    console.log(movie)
    if(movie ==""){
            let parent = document.getElementById("search");
       parent.innerHTML = null;
return ;
    }else{

        getMovie(movie);
    }
}

function showSearch(movies){
    let parent = document.getElementById("search");
    parent.innerHTML = null;

    movies.forEach(function(movie){
 let div = document.createElement("div");
         div.setAttribute("class","searchMovie");

         let img = document.createElement("img");
         img.src = "https://image.tmdb.org/t/p/w500"+movie.poster_path;

         let title = document.createElement("p");
         title.innerText =movie.title;
             

         div.append(img,title);
         parent.append(div);

         //add event listener 
         div.addEventListener("click",function(){
          console.log(movie);
          showDetail(movie);
          //colapse the search div

              let parent = document.getElementById("search");
       parent.innerHTML = null;

         })
        
    });

}


//show detail on individual movie

function showDetail(movie){
let parent = document.getElementById("detail");
parent.innerHTML = null;
parent.style.backgroundImage = "https://image.tmdb.org/t/p/w500"+movie.backdrop_path;

let div1 = document.createElement("div");

let img = document.createElement("img");
img.src = "https://image.tmdb.org/t/p/w500"+movie.poster_path;
 
div1.append(img);

let div2 = document.createElement("div");

let title = document.createElement("h2");
title.innerText = movie.title;

let date = document.createElement("p");
date.innerHTML = movie.release_date;

let overview = document.createElement("p");
overview.innerText = movie.overview;

div2.append(title,date,overview);

parent.append(div1,div2)
          window.location.href="#detail";





}





    </script>
</body>
</html>